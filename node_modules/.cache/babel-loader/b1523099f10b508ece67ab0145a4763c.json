{"ast":null,"code":"/** PURE_IMPORTS_START _Observable,_util_identity,_util_isScheduler PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\n  var resultSelector;\n  var initialState;\n\n  if (arguments.length == 1) {\n    var options = initialStateOrOptions;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions;\n    resultSelector = identity;\n    scheduler = resultSelectorOrObservable;\n  } else {\n    initialState = initialStateOrOptions;\n    resultSelector = resultSelectorOrObservable;\n  }\n\n  return new Observable(function (subscriber) {\n    var state = initialState;\n\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        subscriber: subscriber,\n        iterate: iterate,\n        condition: condition,\n        resultSelector: resultSelector,\n        state: state\n      });\n    }\n\n    do {\n      if (condition) {\n        var conditionResult = void 0;\n\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n\n      var value = void 0;\n\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n\n      subscriber.next(value);\n\n      if (subscriber.closed) {\n        break;\n      }\n\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n\n    return undefined;\n  });\n}\n\nfunction dispatch(state) {\n  var subscriber = state.subscriber,\n      condition = state.condition;\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n\n  if (condition) {\n    var conditionResult = void 0;\n\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n\n  var value;\n\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  subscriber.next(value);\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  return this.schedule(state);\n}","map":{"version":3,"mappings":"AAAA;AAEA,SAASA,UAAT,QAAyB,eAAzB;AAEA,SAASC,QAAT,QAAsB,kBAAtB;AA8PA,SAAMC,WAAN,QAA+B,qBAA/B;OAME,SAAIC,QAAJ,CAAqCC,qBAArC,EAAqCC,SAArC,EAAqCC,OAArC,EAAqCC,0BAArC,EAAqCC,SAArC,EAAqC;EACrC,IAAIC,cAAJ;EAEA,IAAIC,YAAJ;;MACEC,SAAM,OAAN,IAAgB;IAChB,cAAYP,qBAAZ;IACAM,YAAY,UAAQ,aAApB;IACAL,SAAO,GAAGO,OAAQ,UAAlB;IACAN,iBAAiB,QAAjB;IACAG,cAAY,UAAQ,eAAR,IAAkBR,QAA9B;IACDO;SACC,8BAAe,KAA0BK,SAAzC,IAA0CX,uCAA1C,EAA0C;IAC1CQ,eAAcN,qBAAd;IACAK,cAAY,WAAZ;IACDD;GAHC,MAIA;IACAE,eAAcN,qBAAd;IACDK;EAED;;SACE,IAAIT,UAAJ,CAAY,UAAac,UAAb,EAAa;IACzB,IAAIC,oBAAJ;;QACEP,WAAO;aACLA,SAAU,SAAV,CAAUQ,QAAV,EAAU,CAAV,EAAU;QACVF,UAAO,YADG;QAEVR,SAASA,OAFC;QAGVD,oBAHU;QAIVI,cAAK,gBAJK;QAKTM;MALS,CAAV;IAQJ;;;UAEIV,WAAI;QACJ,IAAIY,wBAAJ;;YACE;UACDA;QAAC,SACAC;UACAJ,UAAO,MAAP,CAAiBI,GAAjB;UACD;QACD;;YACE,kBAAW;UACXJ,UAAM,SAAN;UACD;QACF;MACD;;MACA,IAAIK,cAAJ;;UACE;QACDA;MAAC,SACAD;QACAJ,UAAO,MAAP,CAAiBI,GAAjB;QACD;MACD;;MACAJ,UAAI,KAAJ,CAAeK,KAAf;;UACEL,UAAM;QACP;MACD;;UACE;QACDC;MAAC,SACAG;QACAJ,UAAO,MAAP,CAAiBI,GAAjB;QACD;MACF;IAED,SAAO;;IACN;EACJ,CA9CG;AAgDJ;;SACUF;EACR,IAAIF,UAAU,GAACC,KAAM,CAAED,UAAvB;EAAA,IAAuBT,2BAAvB;;MACES,UAAO,SAAU;IAClB;EACD;;MACEC,KAAI;QACF;MACDA;IAAC,SACAG;MACAJ,UAAO,MAAP,CAAiBI,GAAjB;MACD;IACF;SACC;IACDH;EACD;;MACEV,WAAI;IACJ,IAAIY,wBAAJ;;QACE;MACDA;IAAC,SACAC;MACAJ,UAAO,MAAP,CAAiBI,GAAjB;MACD;IACD;;QACE,kBAAW;MACXJ,UAAO,SAAP;MACD;IACD;;QACEA,UAAO,SAAU;MAClB;IACF;EACD;;EACA,IAAIK,KAAJ;;MACE;IACDA;EAAC,SACAD;IACAJ,UAAO,MAAP,CAAiBI,GAAjB;IACD;EACD;;MACEJ,UAAO,SAAU;IAClB;EACD;;EACAA,UAAI,KAAJ,CAAeK,KAAf;;MACEL,UAAO,SAAU;IAClB;EACD;;EACD","names":["Observable","identity","isScheduler","generate","initialStateOrOptions","condition","iterate","resultSelectorOrObservable","scheduler","resultSelector","initialState","arguments","options","undefined","subscriber","state","dispatch","conditionResult","err","value"],"sources":["../../../src/internal/observable/generate.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}