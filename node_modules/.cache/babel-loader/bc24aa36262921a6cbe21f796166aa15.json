{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subscriber,_Subject PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nimport { Subject } from '../Subject';\nexport function windowCount(windowSize, startWindowEvery) {\n  if (startWindowEvery === void 0) {\n    startWindowEvery = 0;\n  }\n\n  return function windowCountOperatorFunction(source) {\n    return source.lift(new WindowCountOperator(windowSize, startWindowEvery));\n  };\n}\n\nvar WindowCountOperator = /*@__PURE__*/function () {\n  function WindowCountOperator(windowSize, startWindowEvery) {\n    this.windowSize = windowSize;\n    this.startWindowEvery = startWindowEvery;\n  }\n\n  WindowCountOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\n  };\n\n  return WindowCountOperator;\n}();\n\nvar WindowCountSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(WindowCountSubscriber, _super);\n\n  function WindowCountSubscriber(destination, windowSize, startWindowEvery) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.destination = destination;\n    _this.windowSize = windowSize;\n    _this.startWindowEvery = startWindowEvery;\n    _this.windows = [new Subject()];\n    _this.count = 0;\n    destination.next(_this.windows[0]);\n    return _this;\n  }\n\n  WindowCountSubscriber.prototype._next = function (value) {\n    var startWindowEvery = this.startWindowEvery > 0 ? this.startWindowEvery : this.windowSize;\n    var destination = this.destination;\n    var windowSize = this.windowSize;\n    var windows = this.windows;\n    var len = windows.length;\n\n    for (var i = 0; i < len && !this.closed; i++) {\n      windows[i].next(value);\n    }\n\n    var c = this.count - windowSize + 1;\n\n    if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\n      windows.shift().complete();\n    }\n\n    if (++this.count % startWindowEvery === 0 && !this.closed) {\n      var window_1 = new Subject();\n      windows.push(window_1);\n      destination.next(window_1);\n    }\n  };\n\n  WindowCountSubscriber.prototype._error = function (err) {\n    var windows = this.windows;\n\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().error(err);\n      }\n    }\n\n    this.destination.error(err);\n  };\n\n  WindowCountSubscriber.prototype._complete = function () {\n    var windows = this.windows;\n\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().complete();\n      }\n    }\n\n    this.destination.complete();\n  };\n\n  WindowCountSubscriber.prototype._unsubscribe = function () {\n    this.count = 0;\n    this.windows = null;\n  };\n\n  return WindowCountSubscriber;\n}(Subscriber);","map":{"version":3,"mappings":";AACA,OAAO,KAAEA,OAAT,MAAqB,OAArB;AAEA,SAASC,UAAT,QAAwB,eAAxB;AAkEA,SAAMC,OAAN,QAAgB,YAAhB;OAC+B;EAC7B,oBAAgB,WAAhB,EAAgB;IACdC,gBAAc,GAAK,CAAnB;EACD;;EACF;IAED;EAEE,CAJD;;;uBAKqB,4BAAwB;EAC5C,SAACC,mBAAD,CAACC,UAAD,EAACF,gBAAD,EAAC;IAED;IACE,wBAAwBA,gBAAxB;EACD;;EACHC,8BAACE,IAAD,GAAC;IAAA;EAOD,CAPA;;EAOuC;CAbjB;;yBAoBlB,gBAAM,UAAYC,MAAZ,EAEP;SALqB,kCAAsCA;;WACxCC,mCAAkBH;IAClB,wBAAgB,IAAhB,kBAAwB,IAAxB;;IALZI,oBAA0BC,WAA1B;IACAD,mBAAkBJ,UAAlB;IAMNI,yBAAsBN,gBAAtB;;IACDM;IAESC;IACR,OAAMD,KAAN;;;uBAEmB,WAAKE,QAAW;IACnC,IAAMR,gBAAe,QAAQA,gBAAR,GAAQ,CAAR,GAAQ,qBAAR,GAAQ,eAA7B;IACA,IAAMO,WAAM,GAAQ,gBAApB;IAEA,cAAc,GAAG,KAAGL,UAApB;QACEO,OAAO,GAAG,KAAKA;QAChBC;;IACD,KAAO,IAAGC,IAAK,CAAf,EAAeA,IAAKD,GAAL,IAAQ,MAAUE,MAAjC,EAAsCD,GAAtC,EAAsC;MAClCF,OAAM,GAAN,CAAWI,IAAX,CAAcC,KAAd;;;QAEHC;;IACD,IAAIA,KAAE,CAAF,IAAOA,IAAKf,gBAAL,KAAwB,CAA/B,IAAqC,CAAI,KAAKY,MAAlD,EAAyD;MACvDH,OAAM,MAAN,GAAeO,QAAf;;;QAEA,eAAYhB,gBAAZ,KAAyB,CAAzB,IAAyB;MAC1B;MACFS;MAESF;IACR;;;uBAES,CAAOU,UAAUC,SAAM,UAAaC,GAAb,EAAa;eACzC,QAAQV;;iBACT;MACF;QACIA,QAAWW,KAAX,GAAkBC,KAAlB,CAAuBF,GAAvB;MACN;IAES;;IACR,KAAMZ,WAAN,CAAgBc,KAAhB,CAAqBF,GAArB;;;uBAES,CAAOF,UAAUK,YAAW,YAAQ;eACzC,QAAQb;;iBACT;MACF;QACIA,QAAWW,KAAX,GAAYJ,QAAZ;MACN;IAES;;IACR,KAAKT,WAAL,CAAeS,QAAf;;;EAEFX,qBAAC,UAAD,CAACkB,YAAD,GAAC;IACH;IAxDuC,KAAUd,OAAV,GAwDtC,IAxDsC;GAuDrC;;;CAhDQ","names":["tslib_1","Subscriber","Subject","startWindowEvery","WindowCountOperator","windowSize","call","_super","WindowCountSubscriber","_this","destination","_next","windows","len","i","closed","next","value","c","complete","prototype","_error","err","shift","error","_complete","_unsubscribe"],"sources":["../../../src/internal/operators/windowCount.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}