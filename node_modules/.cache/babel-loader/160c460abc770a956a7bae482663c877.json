{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { defaultValues } from '@airgap/beacon-types';\n/**\n * @internalapi\n *\n * A storage that can be used in the browser\n */\n\nexport class LocalStorage {\n  constructor(prefix) {\n    this.prefix = prefix;\n  }\n\n  static isSupported() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return Promise.resolve(Boolean(typeof window !== 'undefined') && Boolean(window.localStorage));\n    });\n  }\n\n  get(key) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const value = localStorage.getItem(this.getPrefixedKey(key));\n\n      if (!value) {\n        if (typeof defaultValues[key] === 'object') {\n          return JSON.parse(JSON.stringify(defaultValues[key]));\n        } else {\n          return defaultValues[key];\n        }\n      } else {\n        try {\n          return JSON.parse(value);\n        } catch (jsonParseError) {\n          return value; // TODO: Validate storage\n        }\n      }\n    });\n  }\n\n  set(key, value) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (typeof value === 'string') {\n        return localStorage.setItem(this.getPrefixedKey(key), value);\n      } else {\n        return localStorage.setItem(this.getPrefixedKey(key), JSON.stringify(value));\n      }\n    });\n  }\n\n  delete(key) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return Promise.resolve(localStorage.removeItem(this.getPrefixedKey(key)));\n    });\n  }\n\n  getPrefixedKey(key) {\n    return this.prefix ? `${this.prefix}-${key}` : key;\n  }\n\n}","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAAoDA,aAApD,QAAyE,sBAAzE;AAEA;;;;;;AAKA,OAAM,MAAOC,YAAP,CAAmB;EACvBC,YAA6BC,MAA7B,EAA4C;IAAf;EAAmB;;EACjB,OAAXC,WAAW;;MAC7B,OAAOC,OAAO,CAACC,OAAR,CAAgBC,OAAO,CAAC,OAAOC,MAAP,KAAkB,WAAnB,CAAP,IAA0CD,OAAO,CAACC,MAAM,CAACC,YAAR,CAAjE,CAAP;IACD;EAAA;;EAEYC,GAAG,CAAuBC,GAAvB,EAA6B;;MAC3C,MAAMC,KAAK,GAAGH,YAAY,CAACI,OAAb,CAAqB,KAAKC,cAAL,CAAoBH,GAApB,CAArB,CAAd;;MACA,IAAI,CAACC,KAAL,EAAY;QACV,IAAI,OAAOZ,aAAa,CAACW,GAAD,CAApB,KAA8B,QAAlC,EAA4C;UAC1C,OAAOI,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAejB,aAAa,CAACW,GAAD,CAA5B,CAAX,CAAP;QACD,CAFD,MAEO;UACL,OAAOX,aAAa,CAACW,GAAD,CAApB;QACD;MACF,CAND,MAMO;QACL,IAAI;UACF,OAAOI,IAAI,CAACC,KAAL,CAAWJ,KAAX,CAAP;QACD,CAFD,CAEE,OAAOM,cAAP,EAAuB;UACvB,OAAON,KAAP,CADuB,CACiB;QACzC;MACF;IACF;EAAA;;EAEYO,GAAG,CAAuBR,GAAvB,EAA+BC,KAA/B,EAA6D;;MAC3E,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;QAC7B,OAAOH,YAAY,CAACW,OAAb,CAAqB,KAAKN,cAAL,CAAoBH,GAApB,CAArB,EAA+CC,KAA/C,CAAP;MACD,CAFD,MAEO;QACL,OAAOH,YAAY,CAACW,OAAb,CAAqB,KAAKN,cAAL,CAAoBH,GAApB,CAArB,EAA+CI,IAAI,CAACE,SAAL,CAAeL,KAAf,CAA/C,CAAP;MACD;IACF;EAAA;;EAEYS,MAAM,CAAuBV,GAAvB,EAA6B;;MAC9C,OAAON,OAAO,CAACC,OAAR,CAAgBG,YAAY,CAACa,UAAb,CAAwB,KAAKR,cAAL,CAAoBH,GAApB,CAAxB,CAAhB,CAAP;IACD;EAAA;;EAEOG,cAAc,CAACH,GAAD,EAAY;IAChC,OAAO,KAAKR,MAAL,GAAc,GAAG,KAAKA,MAAM,IAAIQ,GAAG,EAAnC,GAAwCA,GAA/C;EACD;;AArCsB","names":["defaultValues","LocalStorage","constructor","prefix","isSupported","Promise","resolve","Boolean","window","localStorage","get","key","value","getItem","getPrefixedKey","JSON","parse","stringify","jsonParseError","set","setItem","delete","removeItem"],"sourceRoot":"","sources":["../../../src/storage/LocalStorage.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}