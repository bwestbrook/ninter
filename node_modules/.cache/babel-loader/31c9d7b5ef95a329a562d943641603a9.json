{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { empty } from '../observable/empty';\nexport function takeLast(count) {\n  return function takeLastOperatorFunction(source) {\n    if (count === 0) {\n      return empty();\n    } else {\n      return source.lift(new TakeLastOperator(count));\n    }\n  };\n}\n\nvar TakeLastOperator = /*@__PURE__*/function () {\n  function TakeLastOperator(total) {\n    this.total = total;\n\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError();\n    }\n  }\n\n  TakeLastOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeLastSubscriber(subscriber, this.total));\n  };\n\n  return TakeLastOperator;\n}();\n\nvar TakeLastSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(TakeLastSubscriber, _super);\n\n  function TakeLastSubscriber(destination, total) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.total = total;\n    _this.ring = new Array();\n    _this.count = 0;\n    return _this;\n  }\n\n  TakeLastSubscriber.prototype._next = function (value) {\n    var ring = this.ring;\n    var total = this.total;\n    var count = this.count++;\n\n    if (ring.length < total) {\n      ring.push(value);\n    } else {\n      var index = count % total;\n      ring[index] = value;\n    }\n  };\n\n  TakeLastSubscriber.prototype._complete = function () {\n    var destination = this.destination;\n    var count = this.count;\n\n    if (count > 0) {\n      var total = this.count >= this.total ? this.total : this.count;\n      var ring = this.ring;\n\n      for (var i = 0; i < total; i++) {\n        var idx = count++ % total;\n        destination.next(ring[idx]);\n      }\n    }\n\n    destination.complete();\n  };\n\n  return TakeLastSubscriber;\n}(Subscriber);","map":{"version":3,"mappings":";AACA,OAAO,KAAEA,OAAT,MAAqB,OAArB;AACA,SAASC,UAAT,QAAS,eAAT;AACA,SAASC,uBAAT,QAAsB,iCAAtB;AA8CA,SAAMC,KAAN,QAAgB,qBAAhB;OACE,SAAOC,QAAP,CAAgBC,KAAhB,EAAgB;SACd,SAASC,wBAAT,CAAiBC,MAAjB,EAAiB;QACfF,UAAO,GAAK;MACb;WACC;MACD;IACD;EACH;AAED;;IACEG,gCAAiC;WAAbA,iBAAaC;IAC/B,KAAIA,KAAJ,GAASA,KAAT;;QACE,aAAU;MACX;IACF;EAED;;kBACS,CAAMC,UAAUC,OAAK,sBAAmBJ,MAAnB,EAA+B;IAC5D;EACH;;EAVA,OAUCC,gBAVD;AAiBA,CAhBmC;;IAgBCI,4CAAaC,MAAb,EAAa;EAI/Cb,sCAAYa,MAAZ;;WAAAD,mBACEE,aAAML,OAAY;IAD4B,YAAKI,MAAL,CAAKF,KAAQ,IAAR,EAAQG,WAAR,KAAQ,IAAb;;IAHxCC,cAAiBN,KAAjB;IACAM,aAAK,IAAaC,KAAb,EAAL;;IAIP;EAES;;oBACK,CAAIN,UAAMO;IACvB,IAAMC,OAAK,KAAOA,IAAlB;IACA,IAAMT,KAAK,GAAG,KAAKA,KAAnB;IAEA,IAAIJ,KAAK,QAAMA,KAAN,EAAT;;QACEa,IAAI,CAACC,MAAL,GAAUV,OAAO;MAClBS;WACC;MACA,IAAIE,KAAC,GAAMf,KAAG,GAAMI,KAApB;MACDS;IACF;EAES;;oBACF,CAAWR,UAAQW,YAAY;IACrC,IAAIP,WAAQ,GAAK,KAAMA,WAAvB;IAEA,IAAIT,KAAK,GAAG,KAAGA,KAAf;;QACEA,KAAM,MAAK;MACX,IAAMI,KAAI,GAAI,KAAKJ,KAAL,IAAU,UAAV,GAAU,UAAV,GAAU,UAAxB;MAEA,QAAK,GAAK,KAAMa,IAAhB;;WACE,IAAMI,IAAG,GAAIA,IAAKb,OAAMa,KAAM;QAC9B,UAAWjB,KAAK,EAAhB,GAAsBI,KAAtB;QACDK;MACF;IAED;;IACDA;EACH;;EArCoC;CAAA","names":["tslib_1","Subscriber","ArgumentOutOfRangeError","empty","takeLast","count","takeLastOperatorFunction","source","TakeLastOperator","total","prototype","call","TakeLastSubscriber","_super","destination","_this","Array","_next","ring","length","index","_complete","i"],"sources":["../../../src/internal/operators/takeLast.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}